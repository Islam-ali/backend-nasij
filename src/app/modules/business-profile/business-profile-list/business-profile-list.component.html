<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8">
    <div class="w-full mx-auto px-4">
        <p-toast></p-toast>
        <p-confirmDialog></p-confirmDialog>

        <!-- Header -->
        <div class="mb-8 sticky top-0 z-10 bg-gradient-to-br from-gray-50 to-gray-100 pb-4">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div class="flex-1">
                    <div class="flex items-center gap-3">
                        <h1 class="text-3xl font-bold text-gray-900">{{ 'businessProfile.title' | translate }}</h1>
                        @if (hasUnsavedChanges()) {
                        <p-chip [label]="'businessProfile.unsavedChanges' | translate" icon="pi pi-exclamation-circle"
                            styleClass="bg-orange-100 text-orange-800"></p-chip>
                        }
                    </div>
                    <p class="mt-2 text-gray-600">{{ 'businessProfile.description' | translate }}</p>

                    <!-- Progress Bar (only in edit mode) -->
                    @if (isEditMode()) {
                    <div class="mt-3">
                        <div class="flex items-center gap-3">
                            <div class="flex-1 bg-gray-200 rounded-full h-2 overflow-hidden">
                                <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-full transition-all duration-500"
                                    [style.width.%]="formProgress()">
                                </div>
                            </div>
                            <span class="text-sm font-semibold text-gray-700 min-w-[45px]">{{ formProgress() }}%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">{{ 'businessProfile.formProgress' | translate }}</p>
                    </div>
                    }
                </div>

                <div class="flex gap-3 flex-wrap">
                    <p-button *ngIf="!isEditMode()" [label]="'businessProfile.editProfile' | translate" icon="pi pi-pencil"
                        (onClick)="toggleEditMode()" styleClass="p-button-outlined">
                    </p-button>

                    @if (isEditMode()) {
                    <p-button [label]="'common.cancel' | translate" icon="pi pi-times" (onClick)="toggleEditMode()"
                        styleClass="p-button-outlined p-button-secondary">
                    </p-button>
                    <p-button [label]="'businessProfile.saveChanges' | translate" icon="pi pi-check" (onClick)="saveBusinessProfile()"
                        [loading]="saving()" [disabled]="saving()" severity="success"
                        [styleClass]="businessProfileForm.invalid ? 'p-button-warning' : ''"
                        [pTooltip]="businessProfileForm.invalid ? ('businessProfile.saveWarning' | translate) : ('businessProfile.saveSuccess' | translate)"
                        tooltipPosition="bottom">
                    </p-button>
                    }
                </div>
            </div>
        </div>

        <!-- Loading State with Skeleton -->
        @if (loading()) {
        <div class="space-y-6">
            <!-- Basic Information Skeleton -->
            <p-card styleClass="shadow-lg border-0">
                <ng-template pTemplate="header">
                    <div class="p-4 bg-gradient-to-r from-blue-600 to-purple-600">
                        <p-skeleton width="200px" height="1.5rem"></p-skeleton>
                    </div>
                </ng-template>
                <ng-template pTemplate="content">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div>
                            <p-skeleton width="100%" height="200px" borderRadius="16px"></p-skeleton>
                        </div>
                        <div class="lg:col-span-2 space-y-4">
                            <p-skeleton width="100%" height="60px" borderRadius="8px"></p-skeleton>
                            <p-skeleton width="100%" height="120px" borderRadius="8px"></p-skeleton>
                        </div>
                    </div>
                </ng-template>
            </p-card>

            <!-- More Skeletons -->
            <p-card styleClass="shadow-lg border-0">
                <ng-template pTemplate="content">
                    <p-skeleton width="100%" height="200px" borderRadius="8px"></p-skeleton>
                </ng-template>
            </p-card>
        </div>
        }

        <!-- Content -->
        <div *ngIf="!loading()" class="space-y-8">
            <form [formGroup]="businessProfileForm">
                <p-tabView>
                    <!-- Basic Information Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.basicInfo' | translate" leftIcon="pi pi-building">
                        <!-- Basic Information Card -->
                        <p-card styleClass="shadow-lg border-0 mb-4">
                            <ng-template pTemplate="header">
                                <div
                                    class="flex items-center justify-between p-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-t-lg">
                                    <div class="flex items-center gap-3">
                                        <i class="pi pi-building text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.basicInfo.title' | translate }}</h2>
                                    </div>
                                    @if (isEditMode()) {
                                    <p-chip [label]="getSectionProgress('basic') + '%'" icon="pi pi-check-circle"
                                        [styleClass]="getSectionProgress('basic') === 100 ? 'bg-green-100 text-green-800' : 'bg-white/20 text-white'">
                                    </p-chip>
                                    }
                                </div>
                            </ng-template>
                            <ng-template pTemplate="content">
                                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                    <!-- Logo Section -->
                                    <div class="lg:col-span-1">
                                        <div class="text-center">
                                            @if(!isEditMode()) {
                                            <!-- View Mode - Enhanced Logo Display -->
                                            <div class="space-y-4">
                                                <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                                                    <h3
                                                        class="text-lg font-semibold text-gray-800 mb-4 flex items-center justify-center gap-2">
                                                        <i class="pi pi-image text-blue-600"></i>
                                                        {{ 'businessProfile.basicInfo.companyLogos' | translate }}
                                                    </h3>
                                                    <div class="grid grid-cols-1 gap-4">
                                                        <!-- Dark Logo -->
                                                        <div class="text-center">
                                                            <label
                                                                class="block text-sm font-medium text-gray-600 mb-2">{{ 'businessProfile.basicInfo.darkLogo' | translate }}</label>
                                                            <div class="bg-gray-800 rounded-lg p-4">
                                                                <img *ngIf="logoDarkPreview || businessProfile?.logo_dark"
                                                                    [src]="getImageUrl(logoDarkPreview || businessProfile?.logo_dark?.filePath || '')"
                                                                    [alt]="businessProfile?.name?.en + ' Dark Logo'"
                                                                    class="w-24 h-24 object-contain mx-auto"
                                                                    appFallbackImg="/assets/images/default-logo.png">
                                                                <div *ngIf="!logoDarkPreview && !businessProfile?.logo_dark"
                                                                    class="w-24 h-24 bg-gray-600 rounded-lg flex items-center justify-center mx-auto">
                                                                    <i class="pi pi-image text-2xl text-gray-300"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Light Logo -->
                                                        <div class="text-center">
                                                            <label
                                                                class="block text-sm font-medium text-gray-600 mb-2">{{ 'businessProfile.basicInfo.lightLogo' | translate }}</label>
                                                            <div class="bg-gray-100 rounded-lg p-4">
                                                                <img *ngIf="logoLightPreview || businessProfile?.logo_light"
                                                                    [src]="getImageUrl(logoLightPreview || businessProfile?.logo_light?.filePath || '')"
                                                                    [alt]="businessProfile?.name?.en + ' Light Logo'"
                                                                    class="w-24 h-24 object-contain mx-auto"
                                                                    appFallbackImg="/assets/images/default-logo.png">
                                                                <div *ngIf="!logoLightPreview && !businessProfile?.logo_light"
                                                                    class="w-24 h-24 bg-gray-200 rounded-lg flex items-center justify-center mx-auto">
                                                                    <i class="pi pi-image text-2xl text-gray-400"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            }
                                            @else {
                                            <div>
                                                <div class="flex gap-2 flex-wrap mb-4">
                                                    <div>
                                                        <label for="logoDark"
                                                            class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.basicInfo.logoDark' | translate }}</label>
                                                        <app-upload-files [index]="0" [control]="logoDarkControl"
                                                            [filesServer]="businessProfileForm.get('logo_dark')?.value"
                                                            [attr.id]="'logoDark'" [multiple]="false"
                                                            [accept]="'image/*'"></app-upload-files>
                                                    </div>
                                                    <div>
                                                        <label for="logoLight"
                                                            class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.basicInfo.logoLight' | translate }}</label>
                                                        <app-upload-files [index]="1" [control]="logoLightControl"
                                                            [filesServer]="businessProfileForm.get('logo_light')?.value"
                                                            [attr.id]="'logoLight'" [multiple]="false"
                                                            [accept]="'image/*'"></app-upload-files>
                                                    </div>
                                                </div>
                                            </div>
                                            }
                                        </div>
                                    </div>

                                    <!-- Form Fields -->
                                    <div class="lg:col-span-2 space-y-6">
                                        @if(!isEditMode()) {
                                        <!-- View Mode - Enhanced Display -->
                                        <div class="space-y-6">
                                            <!-- Business Name Display -->
                                            <div
                                                class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200">
                                                <h3
                                                    class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                                                    <i class="pi pi-building text-blue-600"></i>
                                                    {{ 'businessProfile.basicInfo.businessName' | translate }}
                                                </h3>
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                        <div class="flex items-center gap-2 mb-2">
                                                            <span
                                                                class="text-sm font-medium text-gray-600">{{ 'common.english' | translate }}</span>
                                                            <i class="pi pi-flag text-blue-500"></i>
                                                        </div>
                                                        <p class="text-lg font-semibold text-gray-900" dir="ltr">
                                                            {{ businessProfile?.name?.en || ('common.notProvided' | translate) }}
                                                        </p>
                                                    </div>
                                                    <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                        <div class="flex items-center gap-2 mb-2">
                                                            <span
                                                                class="text-sm font-medium text-gray-600">{{ 'common.arabic' | translate }}</span>
                                                            <i class="pi pi-flag text-green-500"></i>
                                                        </div>
                                                        <p class="text-lg font-semibold text-gray-900" dir="rtl">
                                                            {{ businessProfile?.name?.ar || ('common.notAvailable' | translate) }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Description Display -->
                                            <div
                                                class="bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-6 border border-green-200">
                                                <h3
                                                    class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                                                    <i class="pi pi-file-edit text-green-600"></i>
                                                    {{ 'businessProfile.basicInfo.businessDescription' | translate }}
                                                </h3>
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                        <div class="flex items-center gap-2 mb-3">
                                                            <span
                                                                class="text-sm font-medium text-gray-600">{{ 'common.english' | translate }}</span>
                                                            <i class="pi pi-flag text-blue-500"></i>
                                                        </div>
                                                        <p class="text-gray-700 leading-relaxed" dir="ltr">
                                                            {{ businessProfile?.description?.en || ('common.noDescription' | translate) }}
                                                        </p>
                                                    </div>
                                                    <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                        <div class="flex items-center gap-2 mb-3">
                                                            <span
                                                                class="text-sm font-medium text-gray-600">{{ 'common.arabic' | translate }}</span>
                                                            <i class="pi pi-flag text-green-500"></i>
                                                        </div>
                                                        <p class="text-gray-700 leading-relaxed" dir="rtl">
                                                            {{ businessProfile?.description?.ar || ('common.noDescriptionAvailable' | translate) }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        } @else {
                                        <!-- Edit Mode - Form Fields -->
                                        <!-- Business Name -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.basicInfo.nameLabel' | translate }} *</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" formGroupName="name">
                                                <div>
                                                    <label for="nameEn"
                                                        class="text-xs text-gray-600 mb-1 flex items-center gap-2">
                                                        {{ 'common.english' | translate }}
                                                        @if (isFieldValid('name', 'en')) {
                                                        <i class="pi pi-check-circle text-green-500 text-sm"></i>
                                                        }
                                                    </label>
                                                    <input id="nameEn" type="text" pInputText formControlName="en"
                                                        class="w-full" dir="ltr"
                                                        [class.p-invalid]="isFieldInvalid('name', 'en')"
                                                        [class.border-green-500]="isFieldValid('name', 'en')"
                                                        [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.basicInfo.nameEnPlaceholder' | translate" />
                                                    @if (isFieldInvalid('name', 'en')) {
                                                    <small class="text-red-500 flex items-center gap-1 mt-1">
                                                        <i class="pi pi-exclamation-circle text-xs"></i>
                                                        {{ getFieldError('name', 'en') }}
                                                    </small>
                                                    }
                                                </div>
                                                <div>
                                                    <label for="nameAr"
                                                        class="block text-xs text-gray-600 mb-1">{{ 'common.arabic' | translate }}</label>
                                                    <input id="nameAr" type="text" pInputText formControlName="ar"
                                                        class="w-full"
                                                        [class.ng-invalid]="businessProfileForm.get('name.ar')?.invalid && businessProfileForm.get('name.ar')?.touched"
                                                        [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.basicInfo.nameArPlaceholder' | translate" dir="rtl" />
                                                    <small *ngIf="getFieldError('name', 'ar')" class="text-red-500">{{
                                                        getFieldError('name', 'ar') }}</small>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Description -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.basicInfo.descriptionLabel' | translate }} *</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4"
                                                formGroupName="description">
                                                <div>
                                                    <label for="descriptionEn"
                                                        class="block text-xs text-gray-600 mb-1">{{ 'common.english' | translate }}</label>
                                                    <textarea id="descriptionEn" pInputTextarea formControlName="en"
                                                        rows="4" class="w-full"
                                                        [class.ng-invalid]="businessProfileForm.get('description.en')?.invalid && businessProfileForm.get('description.en')?.touched"
                                                        [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.basicInfo.descriptionEnPlaceholder' | translate"></textarea>
                                                    <small *ngIf="getFieldError('description', 'en')"
                                                        class="text-red-500">{{ getFieldError('description', 'en')
                                                        }}</small>
                                                </div>
                                                <div>
                                                    <label for="descriptionAr"
                                                        class="block text-xs text-gray-600 mb-1">{{ 'common.arabic' | translate }}</label>
                                                    <textarea id="descriptionAr" pInputTextarea formControlName="ar"
                                                        rows="4" class="w-full"
                                                        [class.ng-invalid]="businessProfileForm.get('description.ar')?.invalid && businessProfileForm.get('description.ar')?.touched"
                                                        [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.basicInfo.descriptionArPlaceholder' | translate" dir="rtl"></textarea>
                                                    <small *ngIf="getFieldError('description', 'ar')"
                                                        class="text-red-500">{{ getFieldError('description', 'ar')
                                                        }}</small>
                                                </div>
                                            </div>
                                        </div>
                                        }
                                    </div>
                                </div>
                            </ng-template>
                        </p-card>
                    </p-tabPanel>

                    <!-- Contact & Social Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.contactSocial' | translate" leftIcon="pi pi-phone">
                        <div class="p-6 space-y-6">
                            <!-- Contact Information Card -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-t-lg">
                                        <i class="pi pi-phone text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.contactSocial.title' | translate }}</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    @if(!isEditMode()) {
                                    <!-- View Mode - Color Display -->
                                    <div
                                        class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                                        <div class="flex items-start gap-4">
                                            <div
                                                class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                                                <i class="pi pi-palette text-purple-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <h3 class="text-lg font-semibold text-gray-800 mb-3">{{ 'businessProfile.branding.primaryBrandColor' | translate }}
                                                </h3>
                                                <div class="flex items-center gap-4">
                                                    <div class="w-24 h-24 rounded-xl shadow-md border-4 border-white"
                                                        [style.backgroundColor]="businessProfile?.primaryColor || '#3B82F6'">
                                                    </div>
                                                    <div class="flex-1">
                                                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                            <p class="text-sm text-gray-600 mb-1">{{ 'businessProfile.branding.hexColorCode' | translate }}</p>
                                                            <p class="text-2xl font-bold text-gray-900 font-mono">
                                                                {{ businessProfile?.primaryColor || '#3B82F6' }}
                                                            </p>
                                                        </div>
                                                        <div class="mt-3 bg-gradient-to-r rounded-lg p-4 text-white"
                                                            [style.backgroundImage]="'linear-gradient(135deg, ' + (businessProfile?.primaryColor || '#3B82F6') + ' 0%, ' + adjustColorBrightness(businessProfile?.primaryColor || '#3B82F6', -30) + ' 100%)'">
                                                            <p class="text-sm font-medium">{{ 'businessProfile.branding.gradientPreview' | translate }}</p>
                                                        </div>
                                                        <!-- Color Shades Preview -->
                                                        <div
                                                            class="mt-4 bg-white rounded-lg p-4 border border-gray-200">
                                                            <p class="text-sm font-medium text-gray-700 mb-3">{{ 'businessProfile.branding.colorShades' | translate }}</p>
                                                            <div class="grid grid-cols-5 gap-2">
                                                                <div *ngFor="let shade of [50, 100, 200, 300, 400, 500, 600, 700, 800, 900]"
                                                                    class="text-center">
                                                                    <div class="w-full h-12 rounded-md border border-gray-200 mb-1"
                                                                        [style.backgroundColor]="generateShade(businessProfile?.primaryColor || '#976735', shade)">
                                                                    </div>
                                                                    <span class="text-xs text-gray-600 font-mono">{{
                                                                        shade }}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    } @else {
                                    <!-- Edit Mode - Color Picker -->
                                    <div
                                        class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                                        <div class="flex items-start gap-4">
                                            <div
                                                class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0">
                                                <i class="pi pi-palette text-purple-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <label class="block text-lg font-semibold text-gray-800 mb-4">
                                                    {{ 'businessProfile.branding.primaryBrandColor' | translate }}
                                                </label>
                                                <div class="flex items-center gap-6">
                                                    <div class="flex flex-col items-center gap-2">
                                                        <div class="w-24 h-24 rounded-xl shadow-lg border-4 border-white flex items-center justify-center cursor-pointer hover:shadow-xl transition-shadow"
                                                            [style.backgroundColor]="businessProfileForm.get('primaryColor')?.value || '#3B82F6'">
                                                            <p-colorPicker formControlName="primaryColor"
                                                                [inline]="false" [appendTo]="'body'"
                                                                [style]="{'width': '100%', 'height': '100%', 'opacity': '0', 'position': 'absolute', 'cursor': 'pointer'}">
                                                            </p-colorPicker>
                                                            <i
                                                                class="pi pi-palette text-white text-2xl drop-shadow-lg"></i>
                                                        </div>
                                                        <small class="text-gray-600 text-center font-medium">{{ 'businessProfile.branding.clickToChange' | translate }}</small>
                                                    </div>
                                                    <div class="flex-1 space-y-4">
                                                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                            <p class="text-sm text-gray-600 mb-2 font-medium">{{ 'businessProfile.branding.selectedColor' | translate }}</p>
                                                            <div class="flex items-center gap-3">
                                                                <div class="w-12 h-12 rounded-lg shadow-md border-2 border-gray-200"
                                                                    [style.backgroundColor]="businessProfileForm.get('primaryColor')?.value || '#3B82F6'">
                                                                </div>
                                                                <input type="text" pInputText
                                                                    formControlName="primaryColor"
                                                                    class="flex-1 font-mono text-lg font-bold uppercase"
                                                                    placeholder="#3B82F6" maxlength="7"
                                                                    pattern="^#[A-Fa-f0-9]{6}$">
                                                            </div>
                                                        </div>
                                                        <div class="bg-gradient-to-r rounded-lg p-4 text-white min-h-[80px] flex items-center justify-center"
                                                            [style.backgroundImage]="'linear-gradient(135deg, ' + (businessProfileForm.get('primaryColor')?.value || '#3B82F6') + ' 0%, ' + adjustColorBrightness(businessProfileForm.get('primaryColor')?.value || '#3B82F6', -30) + ' 100%)'">
                                                            <div class="text-center">
                                                                <p class="text-sm font-medium opacity-90 mb-1">{{ 'businessProfile.branding.gradientPreview' | translate }}</p>
                                                                <p class="text-xs opacity-75">{{ 'businessProfile.branding.thisGradientWillBeUsed' | translate }}</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Color Shades Preview -->
                                                <div class="mt-4 bg-white rounded-lg p-4 border border-gray-200">
                                                    <p class="text-sm font-medium text-gray-700 mb-3">{{ 'businessProfile.branding.colorShades' | translate }}</p>
                                                    <div class="grid grid-cols-5 gap-2">
                                                        <div *ngFor="let shade of [50, 100, 200, 300, 400, 500, 600, 700, 800, 900]"
                                                            class="text-center">
                                                            <div class="w-full h-12 rounded-md border border-gray-200 mb-1"
                                                                [style.backgroundColor]="generateShade(businessProfileForm.get('primaryColor')?.value || '#976735', shade)">
                                                            </div>
                                                            <span class="text-xs text-gray-600 font-mono">{{ shade
                                                                }}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                                    <div class="flex items-start gap-3">
                                                        <i class="pi pi-info-circle text-blue-600 text-lg"></i>
                                                        <div class="flex-1 text-sm text-blue-800">
                                                            <p class="font-medium mb-1">{{ 'businessProfile.branding.aboutPrimaryColor' | translate }}</p>
                                                            <p>{{ 'businessProfile.branding.aboutPrimaryColorDescription' | translate }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    }
                                    <!-- Header Alignment Section -->
                                    @if(!isEditMode()) {
                                    <!-- View Mode - Header Alignment Display -->
                                    <div
                                        class="bg-gradient-to-r from-indigo-50 to-blue-50 rounded-xl p-6 border border-indigo-200 mt-6">
                                        <div class="flex items-start gap-4">
                                            <div
                                                class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center flex-shrink-0">
                                                <i class="pi pi-align-center text-indigo-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <h3 class="text-lg font-semibold text-gray-800 mb-3">{{ 'businessProfile.branding.headerAlignment' | translate }}
                                                </h3>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div class="flex items-center gap-3">
                                                        <span class="text-sm text-gray-600 font-medium">{{ 'businessProfile.branding.headerAlignment' | translate }}:</span>
                                                        <p-chip
                                                            [label]="getHeaderAlignmentLabel(businessProfile?.headerAlignment)"
                                                            [styleClass]="'bg-indigo-100 text-indigo-800 font-semibold'">
                                                        </p-chip>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    } @else {
                                    <!-- Edit Mode - Header Alignment Selector -->
                                    <div
                                        class="bg-gradient-to-r from-indigo-50 to-blue-50 rounded-xl p-6 border border-indigo-200 mt-6">
                                        <div class="flex items-start gap-4">
                                            <div
                                                class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center flex-shrink-0">
                                                <i class="pi pi-align-center text-indigo-600"></i>
                                            </div>
                                            <div class="flex-1">
                                                <label class="block text-lg font-semibold text-gray-800 mb-4">
                                                    {{ 'businessProfile.branding.headerAlignment' | translate }}
                                                </label>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <label for="headerAlignment"
                                                        class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.branding.headerAlignment' | translate }}</label>
                                                    <p-dropdown
                                                        id="headerAlignment"
                                                        formControlName="headerAlignment"
                                                        [options]="headerAlignmentOptions"
                                                        optionLabel="label"
                                                        optionValue="value"
                                                        [placeholder]="'businessProfile.branding.headerAlignment' | translate"
                                                        styleClass="w-full">
                                                    </p-dropdown>
                                                    <small class="text-gray-500 text-xs mt-2 block">{{ 'businessProfile.branding.headerAlignmentDescription' | translate }}</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    }
                                </ng-template>
                            </p-card>

                            <!-- Social Media Card (already exists, keep it) -->
                            <!-- Vodafone Cash Account Card (already exists, keep it) -->
                        </div>
                    </p-tabPanel>

                    <!-- Branding Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.branding' | translate" leftIcon="pi pi-palette">
                        <div class="p-6">
                            <!-- Branding Settings Card -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-t-lg">
                                        <i class="pi pi-palette text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">Branding Settings</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    @if(!isEditMode()) {
                                    <!-- View Mode - Color Display -->
                                    <div class="space-y-6">
                                        <!-- Contact Details -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <!-- Email -->
                                            <div
                                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-envelope text-blue-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.contactSocial.emailAddress' | translate }}</h3>
                                                </div>
                                                <p class="text-gray-700 font-medium">{{
                                                    businessProfile?.contactInfo?.email || ('common.notProvided' | translate) }}</p>
                                            </div>

                                            <!-- Phone -->
                                            <div
                                                class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-phone text-green-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.contactSocial.phoneNumber' | translate }}</h3>
                                                </div>
                                                <p class="text-gray-700 font-medium">{{
                                                    businessProfile?.contactInfo?.phone || ('common.notProvided' | translate) }}</p>
                                            </div>
                                        </div>

                                        <!-- Address -->
                                        <div
                                            class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                                            <div class="flex items-center gap-3 mb-4">
                                                <div
                                                    class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-map-marker text-purple-600"></i>
                                                </div>
                                                <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.contactSocial.businessAddress' | translate }}</h3>
                                            </div>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div class="flex items-center gap-2 mb-3">
                                                        <span class="text-sm font-medium text-gray-600">{{ 'common.english' | translate }}</span>
                                                        <i class="pi pi-flag text-blue-500"></i>
                                                    </div>
                                                    <p class="text-gray-700 leading-relaxed" dir="ltr">
                                                        {{ businessProfile?.contactInfo?.address?.en || ('common.notProvided' | translate) }}
                                                    </p>
                                                </div>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div class="flex items-center gap-2 mb-3">
                                                        <span class="text-sm font-medium text-gray-600">{{ 'common.arabic' | translate }}</span>
                                                        <i class="pi pi-flag text-green-500"></i>
                                                    </div>
                                                    <p class="text-gray-700 leading-relaxed" dir="rtl">
                                                        {{ businessProfile?.contactInfo?.address?.ar || ('common.notAvailable' | translate) }}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Map Location -->
                                        <div *ngIf="businessProfile?.contactInfo?.mapLocation"
                                            class="bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-6 border border-orange-200">
                                            <div class="flex items-center gap-3 mb-4">
                                                <div
                                                    class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-map text-orange-600"></i>
                                                </div>
                                                <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.contactSocial.mapLocation' | translate }}</h3>
                                            </div>
                                            <a [href]="businessProfile?.contactInfo?.mapLocation" target="_blank"
                                                class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium">
                                                <i class="pi pi-external-link"></i>
                                                {{ 'businessProfile.contactSocial.viewOnMap' | translate }}
                                            </a>
                                        </div>
                                    </div>
                                    } @else {
                                    <!-- Edit Mode - Form Fields -->
                                    <div formGroupName="contactInfo" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="email"
                                                class="text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
                                                {{ 'businessProfile.contactSocial.email' | translate }} *
                                                @if (isFieldValid('contactInfo.email')) {
                                                <i class="pi pi-check-circle text-green-500 text-sm"></i>
                                                }
                                            </label>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon">
                                                    <i class="pi pi-envelope"></i>
                                                </span>
                                                <input id="email" type="email" pInputText formControlName="email"
                                                    class="w-full"
                                                    [class.p-invalid]="isFieldInvalid('contactInfo.email')"
                                                    [class.border-green-500]="isFieldValid('contactInfo.email')"
                                                    [readonly]="!isEditMode()" [placeholder]="'businessProfile.contactSocial.emailPlaceholder' | translate" />
                                            </div>
                                            @if (isFieldInvalid('contactInfo.email')) {
                                            <small class="text-red-500 flex items-center gap-1 mt-1">
                                                <i class="pi pi-exclamation-circle text-xs"></i>
                                                {{ getFieldError('contactInfo.email') }}
                                            </small>
                                            }
                                        </div>

                                        <div>
                                            <label for="phone"
                                                class="text-sm font-medium text-gray-700 mb-2 flex items-center gap-2">
                                                {{ 'businessProfile.contactSocial.phone' | translate }} *
                                                @if (isFieldValid('contactInfo.phone')) {
                                                <i class="pi pi-check-circle text-green-500 text-sm"></i>
                                                }
                                            </label>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon">
                                                    <i class="pi pi-phone"></i>
                                                </span>
                                                <input id="phone" type="tel" pInputText formControlName="phone"
                                                    class="w-full"
                                                    [class.p-invalid]="isFieldInvalid('contactInfo.phone')"
                                                    [class.border-green-500]="isFieldValid('contactInfo.phone')"
                                                    [readonly]="!isEditMode()" [placeholder]="'businessProfile.contactSocial.phonePlaceholder' | translate" />
                                            </div>
                                            @if (isFieldInvalid('contactInfo.phone')) {
                                            <small class="text-red-500 flex items-center gap-1 mt-1">
                                                <i class="pi pi-exclamation-circle text-xs"></i>
                                                {{ getFieldError('contactInfo.phone') }}
                                            </small>
                                            }
                                        </div>

                                        <div class="md:col-span-2">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.contactSocial.address' | translate }} *</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" formGroupName="address">
                                                <div>
                                                    <label for="addressEn"
                                                        class="block text-xs text-gray-600 mb-1">{{ 'common.english' | translate }}</label>
                                                    <textarea id="addressEn" pInputTextarea formControlName="en"
                                                        rows="3" class="w-full"
                                                        [class.ng-invalid]="businessProfileForm.get('contactInfo.address.en')?.invalid && businessProfileForm.get('contactInfo.address.en')?.touched"
                                                        [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.contactSocial.addressEnPlaceholder' | translate"></textarea>
                                                    <small *ngIf="getFieldError('contactInfo.address', 'en')"
                                                        class="text-red-500">{{ getFieldError('contactInfo.address',
                                                        'en') }}</small>
                                                </div>
                                                <div>
                                                    <label for="addressAr"
                                                        class="block text-xs text-gray-600 mb-1">{{ 'common.arabic' | translate }}</label>
                                                    <textarea id="addressAr" pInputTextarea formControlName="ar"
                                                        rows="3" class="w-full"
                                                        [class.ng-invalid]="businessProfileForm.get('contactInfo.address.ar')?.invalid && businessProfileForm.get('contactInfo.address.ar')?.touched"
                                                        [readonly]="!isEditMode()" [placeholder]="'businessProfile.contactSocial.addressArPlaceholder' | translate"
                                                        dir="rtl"></textarea>
                                                    <small *ngIf="getFieldError('contactInfo.address', 'ar')"
                                                        class="text-red-500">{{ getFieldError('contactInfo.address',
                                                        'ar') }}</small>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="md:col-span-2">
                                            <label for="mapLocation"
                                                class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.contactSocial.mapLocationUrl' | translate }}</label>
                                            <input id="mapLocation" type="url" pInputText formControlName="mapLocation"
                                                class="w-full" [placeholder]="'businessProfile.contactSocial.mapLocationPlaceholder' | translate"
                                                [readonly]="!isEditMode()" />
                                        </div>
                                    </div>
                                    }
                                </ng-template>
                            </p-card>
                        </div>
                    </p-tabPanel>

                    <!-- Legal & FAQ Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.legalFaq' | translate" leftIcon="pi pi-file">
                        <div class="p-6 space-y-6">
                            <!-- FAQ and Legal Documents will go here -->
                            <!-- They are already in the file, just need proper structure -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-t-lg">
                                        <i class="pi pi-phone text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">Vodafone Cash Account</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    @if(!isEditMode()) {
                                    <!-- View Mode - Enhanced Vodafone Cash Account Display -->
                                    <div class="space-y-6">
                                        <div
                                            class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200">
                                            <div class="flex items-center gap-3 mb-4">
                                                <div
                                                    class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-phone text-purple-600"></i>
                                                </div>
                                                <h3 class="text-lg font-semibold text-gray-800">Vodafone Cash Account
                                                </h3>
                                            </div>
                                            <p class="text-gray-700 font-medium">{{ businessProfile?.vodafoneCashAccount
                                                || 'Not provided' }}</p>
                                        </div>
                                    </div>
                                    } @else {
                                    <div>
                                        <label for="vodafoneCashAccount"
                                            class="block text-sm font-medium text-gray-700 mb-2">Vodafone Cash Account
                                            *</label>
                                        <input id="vodafoneCashAccount" type="text" pInputText
                                            formControlName="vodafoneCashAccount" class="w-full"
                                            [readonly]="!isEditMode()" />
                                    </div>
                                    }
                                </ng-template>
                            </p-card>
                        </div>
                    </p-tabPanel>

                    <!-- Payment Settings Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.paymentSettings' | translate" leftIcon="pi pi-credit-card">
                        <div class="p-6">
                            <!-- Paymob Payment Settings Card -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-t-lg">
                                        <i class="pi pi-credit-card text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.paymentSettings.title' | translate }}</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <div formGroupName="paymobSettings" class="space-y-6">
                                        <!-- Enable/Disable Toggle -->
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-200">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-power-off text-indigo-600"></i>
                                                </div>
                                                <div>
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.paymentSettings.enablePaymobPayments' | translate }}</h3>
                                                    <p class="text-sm text-gray-600">{{ 'businessProfile.paymentSettings.useDashboardSettings' | translate }}</p>
                                                </div>
                                            </div>
                                            <p-toggleButton formControlName="enabled" [onLabel]="'businessProfile.paymentSettings.enabled' | translate"
                                                [offLabel]="'businessProfile.paymentSettings.disabled' | translate" [onIcon]="'pi pi-check'"
                                                [offIcon]="'pi pi-times'" styleClass="p-button-sm">
                                            </p-toggleButton>
                                        </div>

                                        @if(businessProfileForm.get('paymobSettings.enabled')?.value) {
                                        <div
                                            class="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-gray-200">
                                            <!-- API Key -->
                                            <div class="md:col-span-2">
                                                <label for="paymobApiKey"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.apiKey' | translate }} <span class="text-red-500">*</span>
                                                </label>
                                                <input id="paymobApiKey" type="password" pInputText
                                                    formControlName="apiKey" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.apiKeyPlaceholder' | translate"
                                                    [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.apiKeyDescription' | translate }}</small>
                                            </div>

                                            <!-- Card Integration ID -->
                                            <div>
                                                <label for="paymobIntegrationId"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.cardIntegrationId' | translate }} <span class="text-red-500">*</span>
                                                </label>
                                                <input id="paymobIntegrationId" type="text" pInputText
                                                    formControlName="integrationId" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.cardIntegrationIdPlaceholder' | translate" [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.cardIntegrationIdDescription' | translate }}</small>
                                            </div>

                                            <!-- Wallet Integration ID -->
                                            <div>
                                                <label for="paymobWalletIntegrationId"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.walletIntegrationId' | translate }}
                                                </label>
                                                <input id="paymobWalletIntegrationId" type="text" pInputText
                                                    formControlName="walletIntegrationId" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.walletIntegrationIdPlaceholder' | translate" [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.walletIntegrationIdDescription' | translate }}</small>
                                            </div>

                                            <!-- Iframe ID -->
                                            <div>
                                                <label for="paymobIframeId"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.iframeId' | translate }} <span class="text-red-500">*</span>
                                                </label>
                                                <input id="paymobIframeId" type="text" pInputText
                                                    formControlName="iframeId" class="w-full" [placeholder]="'businessProfile.paymentSettings.iframeIdPlaceholder' | translate"
                                                    [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.iframeIdDescription' | translate }}</small>
                                            </div>

                                            <!-- HMAC Secret -->
                                            <div>
                                                <label for="paymobHmacSecret"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.hmacSecret' | translate }}
                                                </label>
                                                <input id="paymobHmacSecret" type="password" pInputText
                                                    formControlName="hmacSecret" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.hmacSecretPlaceholder' | translate"
                                                    [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.hmacSecretDescription' | translate }}</small>
                                            </div>

                                            <!-- Callback URL -->
                                            <div>
                                                <label for="paymobCallbackUrl"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.callbackUrl' | translate }}
                                                </label>
                                                <input id="paymobCallbackUrl" type="url" pInputText
                                                    formControlName="callbackUrl" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.callbackUrlPlaceholder' | translate" [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.callbackUrlDescription' | translate }}</small>
                                            </div>

                                            <!-- Webhook URL -->
                                            <div>
                                                <label for="paymobWebhookUrl"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.webhookUrl' | translate }}
                                                </label>
                                                <input id="paymobWebhookUrl" type="url" pInputText
                                                    formControlName="webhookUrl" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.webhookUrlPlaceholder' | translate" [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.webhookUrlDescription' | translate }}</small>
                                            </div>

                                            <!-- Response Callback URL -->
                                            <div>
                                                <label for="paymobResponseCallbackUrl"
                                                    class="block text-sm font-semibold text-gray-700 mb-2">
                                                    {{ 'businessProfile.paymentSettings.responseCallbackUrl' | translate }}
                                                </label>
                                                <input id="paymobResponseCallbackUrl" type="url" pInputText
                                                    formControlName="responseCallbackUrl" class="w-full"
                                                    [placeholder]="'businessProfile.paymentSettings.responseCallbackUrlPlaceholder' | translate" [readonly]="!isEditMode()" />
                                                <small class="text-gray-500">{{ 'businessProfile.paymentSettings.responseCallbackUrlDescription' | translate }}</small>
                                            </div>
                                        </div>

                                        <!-- Info Box -->
                                        <div
                                            class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                                            <div class="flex items-start gap-3">
                                                <i
                                                    class="pi pi-info-circle text-blue-600 dark:text-blue-400 text-xl"></i>
                                                <div class="flex-1">
                                                    <h4 class="font-semibold text-blue-900 dark:text-blue-100 mb-2">
                                                        {{ 'businessProfile.paymentSettings.importantNotes' | translate }}</h4>
                                                    <p class="text-sm text-blue-800 dark:text-blue-200">
                                                        {{ 'businessProfile.paymentSettings.importantNotesDescription' | translate }}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        } @else {
                                        <div
                                            class="text-center py-8 bg-gray-50 dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700">
                                            <i class="pi pi-lock text-4xl text-gray-400 mb-4"></i>
                                            <p class="text-gray-600 dark:text-gray-400">{{ 'businessProfile.paymentSettings.enablePaymobPayments' | translate }}</p>
                                        </div>
                                        }
                                    </div>
                                </ng-template>
                            </p-card>

                            <!-- Payment Method Settings Card -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-green-600 to-teal-600 text-white rounded-t-lg">
                                        <i class="pi pi-money-bill text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.paymentMethodSettings.title' | translate }}</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <div formGroupName="paymentMethodSettings" class="space-y-6">
                                        <!-- Cash on Delivery Toggle -->
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl border border-green-200">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-money-bill text-green-600"></i>
                                                </div>
                                                <div>
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.paymentMethodSettings.cashOnDelivery' | translate }}
                                                    </h3>
                                                    <p class="text-sm text-gray-600">{{ 'businessProfile.paymentMethodSettings.cashOnDeliveryDescription' | translate }}
                                                    </p>
                                                </div>
                                            </div>
                                            <p-toggleButton formControlName="cashEnabled" [onLabel]="'businessProfile.paymentSettings.enabled' | translate"
                                                [offLabel]="'businessProfile.paymentSettings.disabled' | translate" [onIcon]="'pi pi-check'"
                                                [offIcon]="'pi pi-times'" styleClass="p-button-sm">
                                            </p-toggleButton>
                                        </div>

                                        <!-- Wallet Payment Toggle -->
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-wallet text-purple-600"></i>
                                                </div>
                                                <div class="flex-1">
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.paymentMethodSettings.walletPayment' | translate }}</h3>
                                                    <p class="text-sm text-gray-600">{{ 'businessProfile.paymentMethodSettings.walletPaymentDescription' | translate }}</p>
                                                </div>
                                            </div>
                                            <p-toggleButton formControlName="walletEnabled" [onLabel]="'businessProfile.paymentSettings.enabled' | translate"
                                                [offLabel]="'businessProfile.paymentSettings.disabled' | translate" [onIcon]="'pi pi-check'"
                                                [offIcon]="'pi pi-times'" styleClass="p-button-sm">
                                            </p-toggleButton>
                                        </div>

                                        @if(businessProfileForm.get('paymentMethodSettings.walletEnabled')?.value) {
                                        <div class="pt-4 border-t border-gray-200">
                                            <label for="walletAccountNumber"
                                                class="block text-sm font-semibold text-gray-700 mb-2">
                                                {{ 'businessProfile.paymentMethodSettings.walletAccountNumber' | translate }}
                                            </label>
                                            <input id="walletAccountNumber" type="text" pInputText
                                                formControlName="walletAccountNumber" class="w-full"
                                                [placeholder]="'businessProfile.paymentMethodSettings.walletAccountNumberPlaceholder' | translate"
                                                [readonly]="!isEditMode()" />
                                            <small class="text-gray-500">{{ 'businessProfile.paymentMethodSettings.walletAccountNumberDescription' | translate }}</small>
                                        </div>
                                        }

                                        <!-- Paymob Payment Toggle -->
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-200">
                                            <div class="flex items-center gap-3">
                                                <div
                                                    class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                                                    <i class="pi pi-credit-card text-indigo-600"></i>
                                                </div>
                                                <div>
                                                    <h3 class="text-lg font-semibold text-gray-800">{{ 'businessProfile.paymentMethodSettings.paymobPayment' | translate }}
                                                    </h3>
                                                    <p class="text-sm text-gray-600">{{ 'businessProfile.paymentMethodSettings.paymobPaymentDescription' | translate }}</p>
                                                </div>
                                            </div>
                                            <p-toggleButton formControlName="paymobEnabled" [onLabel]="'businessProfile.paymentSettings.enabled' | translate"
                                                [offLabel]="'businessProfile.paymentSettings.disabled' | translate" [onIcon]="'pi pi-check'"
                                                [offIcon]="'pi pi-times'" styleClass="p-button-sm">
                                            </p-toggleButton>
                                        </div>

                                        <!-- Info Box -->
                                        <div
                                            class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg">
                                            <div class="flex items-start gap-3">
                                                <i
                                                    class="pi pi-info-circle text-blue-600 dark:text-blue-400 text-xl"></i>
                                                <div class="flex-1">
                                                    <h4 class="font-semibold text-blue-900 dark:text-blue-100 mb-2">
                                                        {{ 'businessProfile.paymentMethodSettings.paymentMethodConfiguration' | translate }}</h4>
                                                    <ul
                                                        class="text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside">
                                                        <li>{{ 'businessProfile.paymentMethodSettings.onlyEnabledMethods' | translate }}</li>
                                                        <li>{{ 'businessProfile.paymentMethodSettings.walletRequiresAccount' | translate }}</li>
                                                        <li>{{ 'businessProfile.paymentMethodSettings.paymobRequiresSettings' | translate }}</li>
                                                        <li>{{ 'businessProfile.paymentMethodSettings.changesSavedOnProfile' | translate }}</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-card>

                            <!-- Social Media Card -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-pink-600 to-purple-600 text-white rounded-t-lg">
                                        <i class="pi pi-share-alt text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">Social Media Links</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    @if(!isEditMode()) {
                                    <!-- View Mode - Enhanced Social Media Display -->
                                    <div *ngIf="hasSocialMedia(); else noSocialMedia">
                                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            <!-- Facebook -->
                                            <div *ngIf="businessProfile?.socialMedia?.facebook"
                                                class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200 hover:shadow-md transition-shadow">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-facebook text-white text-sm"></i>
                                                    </div>
                                                    <span class="font-semibold text-gray-800">Facebook</span>
                                                </div>
                                                <a [href]="businessProfile?.socialMedia?.facebook" target="_blank"
                                                    class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1">
                                                    <i class="pi pi-external-link text-xs"></i>
                                                    Visit Page
                                                </a>
                                            </div>

                                            <!-- Instagram -->
                                            <div *ngIf="businessProfile?.socialMedia?.instagram"
                                                class="bg-gradient-to-r from-pink-50 to-pink-100 rounded-xl p-4 border border-pink-200 hover:shadow-md transition-shadow">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-8 h-8 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-instagram text-white text-sm"></i>
                                                    </div>
                                                    <span class="font-semibold text-gray-800">Instagram</span>
                                                </div>
                                                <a [href]="businessProfile?.socialMedia?.instagram" target="_blank"
                                                    class="text-pink-600 hover:text-pink-800 text-sm font-medium flex items-center gap-1">
                                                    <i class="pi pi-external-link text-xs"></i>
                                                    Visit Profile
                                                </a>
                                            </div>

                                            <!-- Twitter -->
                                            <div *ngIf="businessProfile?.socialMedia?.twitter"
                                                class="bg-gradient-to-r from-sky-50 to-sky-100 rounded-xl p-4 border border-sky-200 hover:shadow-md transition-shadow">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-8 h-8 bg-sky-500 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-twitter text-white text-sm"></i>
                                                    </div>
                                                    <span class="font-semibold text-gray-800">Twitter</span>
                                                </div>
                                                <a [href]="businessProfile?.socialMedia?.twitter" target="_blank"
                                                    class="text-sky-600 hover:text-sky-800 text-sm font-medium flex items-center gap-1">
                                                    <i class="pi pi-external-link text-xs"></i>
                                                    Visit Profile
                                                </a>
                                            </div>

                                            <!-- LinkedIn -->
                                            <div *ngIf="businessProfile?.socialMedia?.linkedin"
                                                class="bg-gradient-to-r from-blue-50 to-indigo-100 rounded-xl p-4 border border-blue-200 hover:shadow-md transition-shadow">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-8 h-8 bg-blue-700 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-linkedin text-white text-sm"></i>
                                                    </div>
                                                    <span class="font-semibold text-gray-800">LinkedIn</span>
                                                </div>
                                                <a [href]="businessProfile?.socialMedia?.linkedin" target="_blank"
                                                    class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1">
                                                    <i class="pi pi-external-link text-xs"></i>
                                                    Visit Company
                                                </a>
                                            </div>

                                            <!-- TikTok -->
                                            <div *ngIf="businessProfile?.socialMedia?.tiktok"
                                                class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-200 hover:shadow-md transition-shadow">
                                                <div class="flex items-center gap-3 mb-3">
                                                    <div
                                                        class="w-8 h-8 bg-black rounded-full flex items-center justify-center">
                                                        <i class="pi pi-video text-white text-sm"></i>
                                                    </div>
                                                    <span class="font-semibold text-gray-800">TikTok</span>
                                                </div>
                                                <a [href]="businessProfile?.socialMedia?.tiktok" target="_blank"
                                                    class="text-gray-600 hover:text-gray-800 text-sm font-medium flex items-center gap-1">
                                                    <i class="pi pi-external-link text-xs"></i>
                                                    Visit Profile
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <ng-template #noSocialMedia>
                                        <div class="text-center py-12">
                                            <div
                                                class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                                <i class="pi pi-share-alt text-3xl text-gray-400"></i>
                                            </div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2">No Social Media Links
                                            </h3>
                                            <p class="text-gray-600">No social media links have been added yet.</p>
                                        </div>
                                    </ng-template>
                                    } @else {
                                    <!-- Edit Mode - Form Fields -->
                                    <div formGroupName="socialMedia" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="facebook"
                                                class="block text-sm font-medium text-gray-700 mb-2">Facebook</label>
                                            <input id="facebook" type="url" pInputText formControlName="facebook"
                                                class="w-full" placeholder="https://facebook.com/yourpage"
                                                [readonly]="!isEditMode()" />
                                        </div>

                                        <div>
                                            <label for="instagram"
                                                class="block text-sm font-medium text-gray-700 mb-2">Instagram</label>
                                            <input id="instagram" type="url" pInputText formControlName="instagram"
                                                class="w-full" placeholder="https://instagram.com/yourpage"
                                                [readonly]="!isEditMode()" />
                                        </div>

                                        <div>
                                            <label for="twitter"
                                                class="block text-sm font-medium text-gray-700 mb-2">Twitter</label>
                                            <input id="twitter" type="url" pInputText formControlName="twitter"
                                                class="w-full" placeholder="https://twitter.com/yourpage"
                                                [readonly]="!isEditMode()" />
                                        </div>

                                        <div>
                                            <label for="linkedin"
                                                class="block text-sm font-medium text-gray-700 mb-2">LinkedIn</label>
                                            <input id="linkedin" type="url" pInputText formControlName="linkedin"
                                                class="w-full" placeholder="https://linkedin.com/company/yourcompany"
                                                [readonly]="!isEditMode()" />
                                        </div>

                                        <div>
                                            <label for="tiktok"
                                                class="block text-sm font-medium text-gray-700 mb-2">TikTok</label>
                                            <input id="tiktok" type="url" pInputText formControlName="tiktok"
                                                class="w-full" placeholder="https://tiktok.com/@yourpage"
                                                [readonly]="!isEditMode()" />
                                        </div>
                                    </div>
                                    }
                                </ng-template>
                            </p-card>

                            <!-- FAQ Section -->
                            <p-card styleClass="shadow-lg border-0 mb-4">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-t-lg">
                                        <div class="flex items-center gap-3">
                                            <i class="pi pi-question-circle text-2xl"></i>
                                            <h2 class="text-xl font-semibold m-0">Frequently Asked Questions</h2>
                                            <span
                                                class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-sm font-medium">
                                                {{ faqArray.length }} {{ faqArray.length === 1 ? 'Question' :
                                                'Questions' }}
                                            </span>
                                        </div>
                                        <div class="flex gap-2">
                                            <p-button *ngIf="isEditMode() && faqArray.length > 0" label="Clear All"
                                                icon="pi pi-trash" (onClick)="clearAllFAQ()" severity="danger"
                                                styleClass="p-button-outlined p-button-sm"></p-button>
                                            <p-button *ngIf="isEditMode()" label="Add FAQ" icon="pi pi-plus"
                                                (onClick)="addFAQ()"
                                                styleClass="p-button-outlined p-button-sm"></p-button>
                                        </div>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <!-- View Mode - Enhanced FAQ Display -->
                                    <div *ngIf="!isEditMode()" class="space-y-4">
                                        <div *ngIf="faqArray.length > 0; else noFAQ">
                                            <div class="grid grid-cols-1 gap-4">
                                                <div *ngFor="let faqGroup of faqArray.controls; let i = index"
                                                    class="bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-6 border border-orange-200 hover:shadow-md transition-all duration-300">

                                                    <!-- FAQ Header -->
                                                    <div class="flex items-start gap-4 mb-4">
                                                        <div
                                                            class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">
                                                            {{ i + 1 }}
                                                        </div>
                                                        <div class="flex-1">
                                                            <h3 class="text-lg font-semibold text-gray-900 mb-2"
                                                                dir="ltr">
                                                                {{ faqGroup.get('question.en')?.value || 'Question ' +
                                                                (i + 1) }}
                                                            </h3>
                                                            <h3 class="text-lg font-semibold text-gray-900 mb-2"
                                                                dir="rtl">
                                                                {{ faqGroup.get('question.ar')?.value || ' ' + (i +
                                                                1) }}
                                                            </h3>
                                                        </div>
                                                    </div>

                                                    <!-- FAQ Answer -->
                                                    <div class="space-y-4">
                                                        <!-- English Answer -->
                                                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                            <div class="flex items-center gap-2 mb-3">
                                                                <i class="pi pi-flag text-blue-500"></i>
                                                                <span class="text-sm font-medium text-gray-600">English
                                                                    Answer</span>
                                                            </div>
                                                            <p class="text-gray-700 leading-relaxed" dir="ltr">
                                                                {{ faqGroup.get('answer.en')?.value || 'No answerprovided.' }}
                                                            </p>
                                                        </div>

                                                        <!-- Arabic Answer -->
                                                        <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                            <div class="flex items-center gap-2 mb-3">
                                                                <i class="pi pi-flag text-green-500"></i>
                                                                <span class="text-sm font-medium text-gray-600">
                                                                    </span>
                                                            </div>
                                                            <p class="text-gray-700 leading-relaxed" dir="rtl">
                                                                {{ faqGroup.get('answer.ar')?.value || 'No answer provided.' }}
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <ng-template #noFAQ>
                                            <div class="text-center py-16">
                                                <div
                                                    class="w-24 h-24 bg-gradient-to-br from-orange-100 to-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                                    <i class="pi pi-question-circle text-4xl text-orange-500"></i>
                                                </div>
                                                <h3 class="text-xl font-semibold text-gray-900 mb-3">No FAQ Items Yet
                                                </h3>
                                                <p class="text-gray-600 mb-6 max-w-md mx-auto">
                                                    Start building your FAQ section by adding common questions and their
                                                    answers.
                                                    This will help your customers find information quickly.
                                                </p>
                                                <p-button label="Add Your First FAQ" icon="pi pi-plus"
                                                    (onClick)="isEditMode.set(true)"
                                                    styleClass="p-button-success"></p-button>
                                            </div>
                                        </ng-template>
                                    </div>

                                    <!-- Edit Mode - Form Style -->
                                    <div *ngIf="isEditMode()" formArrayName="faq" class="space-y-6">
                                        <div *ngFor="let faqGroup of faqArray.controls; let i = index"
                                            [formGroupName]="i"
                                            class="relative border border-orange-200 rounded-xl p-6 bg-gradient-to-br from-orange-50 to-red-50 hover:shadow-md transition-all duration-300">

                                            <!-- FAQ Number Badge -->
                                            <div
                                                class="absolute -top-3 -left-3 w-8 h-8 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold shadow-lg">
                                                {{ i + 1 }}
                                            </div>

                                            <!-- Header -->
                                            <div class="flex justify-between items-start mb-6">
                                                <div class="flex items-center gap-3">
                                                    <div
                                                        class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-question-circle text-orange-600"></i>
                                                    </div>
                                                    <h4 class="text-lg font-semibold text-gray-900">FAQ Item #{{ i + 1
                                                        }}</h4>
                                                </div>
                                                <div class="flex gap-2">
                                                    <p-button *ngIf="i > 0" type="button" icon="pi pi-arrow-up"
                                                        (onClick)="moveFAQ(i, 'up')"
                                                        styleClass="p-button-text p-button-sm"
                                                        pTooltip="Move Up"></p-button>
                                                    <p-button *ngIf="i < faqArray.length - 1" type="button"
                                                        icon="pi pi-arrow-down" (onClick)="moveFAQ(i, 'down')"
                                                        styleClass="p-button-text p-button-sm"
                                                        pTooltip="Move Down"></p-button>
                                                    <p-button type="button" icon="pi pi-trash" severity="danger"
                                                        (onClick)="removeFAQ(i)" styleClass="p-button-text p-button-sm"
                                                        pTooltip="Delete FAQ"></p-button>
                                                </div>
                                            </div>

                                            <!-- Form Fields -->
                                            <div class="grid grid-cols-1 gap-6">
                                                <!-- Question -->
                                                <div formGroupName="question">
                                                    <label
                                                        class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-3">
                                                        <i class="pi pi-question text-orange-600"></i>
                                                        Question *
                                                    </label>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        <div>
                                                            <label [for]="'questionEn' + i"
                                                                class="block text-xs text-gray-600 mb-1">English</label>
                                                            <input [id]="'questionEn' + i" type="text" pInputText
                                                                formControlName="en"
                                                                class="w-full p-3 border-2 transition-colors duration-200"
                                                                [class.border-orange-300]="faqGroup.get('question.en')?.valid && faqGroup.get('question.en')?.touched"
                                                                [class.border-red-300]="faqGroup.get('question.en')?.invalid && faqGroup.get('question.en')?.touched"
                                                                [class.border-gray-300]="!faqGroup.get('question.en')?.touched"
                                                                placeholder="Enter your question in English..." />
                                                            <div class="mt-2">
                                                                <small
                                                                    *ngIf="faqGroup.get('question.en')?.invalid && faqGroup.get('question.en')?.touched"
                                                                    class="text-red-500 flex items-center gap-1">
                                                                    <i class="pi pi-exclamation-triangle text-xs"></i>
                                                                    English question is required
                                                                </small>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <label [for]="'questionAr' + i"
                                                                class="block text-xs text-gray-600 mb-1"></label>
                                                            <input [id]="'questionAr' + i" type="text" pInputText
                                                                formControlName="ar"
                                                                class="w-full p-3 border-2 transition-colors duration-200"
                                                                [class.border-orange-300]="faqGroup.get('question.ar')?.valid && faqGroup.get('question.ar')?.touched"
                                                                [class.border-red-300]="faqGroup.get('question.ar')?.invalid && faqGroup.get('question.ar')?.touched"
                                                                [class.border-gray-300]="!faqGroup.get('question.ar')?.touched"
                                                                placeholder="  ..." dir="rtl" />
                                                            <div class="mt-2">
                                                                <small
                                                                    *ngIf="faqGroup.get('question.ar')?.invalid && faqGroup.get('question.ar')?.touched"
                                                                    class="text-red-500 flex items-center gap-1">
                                                                    <i class="pi pi-exclamation-triangle text-xs"></i>
                                                                      
                                                                </small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Answer -->
                                                <div formGroupName="answer">
                                                    <label
                                                        class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-3">
                                                        <i class="pi pi-comment text-orange-600"></i>
                                                        Answer *
                                                    </label>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        <div>
                                                            <label [for]="'answerEn' + i"
                                                                class="block text-xs text-gray-600 mb-1">English</label>
                                                            <textarea [id]="'answerEn' + i" pInputTextarea
                                                                formControlName="en" rows="4"
                                                                class="w-full p-3 border-2 transition-colors duration-200 resize-none"
                                                                [class.border-orange-300]="faqGroup.get('answer.en')?.valid && faqGroup.get('answer.en')?.touched"
                                                                [class.border-red-300]="faqGroup.get('answer.en')?.invalid && faqGroup.get('answer.en')?.touched"
                                                                [class.border-gray-300]="!faqGroup.get('answer.en')?.touched"
                                                                placeholder="Provide a detailed answer in English..."></textarea>
                                                            <div class="mt-2 flex items-center justify-between">
                                                                <div class="flex items-center gap-2">
                                                                    <small
                                                                        *ngIf="faqGroup.get('answer.en')?.invalid && faqGroup.get('answer.en')?.touched"
                                                                        class="text-red-500 flex items-center gap-1">
                                                                        <i
                                                                            class="pi pi-exclamation-triangle text-xs"></i>
                                                                        English answer is required
                                                                    </small>
                                                                </div>
                                                                <small class="text-gray-500">
                                                                    {{ faqGroup.get('answer.en')?.value?.length || 0 }}
                                                                    characters
                                                                </small>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <label [for]="'answerAr' + i"
                                                                class="block text-xs text-gray-600 mb-1"></label>
                                                            <textarea [id]="'answerAr' + i" pInputTextarea
                                                                formControlName="ar" rows="4"
                                                                class="w-full p-3 border-2 transition-colors duration-200 resize-none"
                                                                [class.border-orange-300]="faqGroup.get('answer.ar')?.valid && faqGroup.get('answer.ar')?.touched"
                                                                [class.border-red-300]="faqGroup.get('answer.ar')?.invalid && faqGroup.get('answer.ar')?.touched"
                                                                [class.border-gray-300]="!faqGroup.get('answer.ar')?.touched"
                                                                placeholder="   ..."
                                                                dir="rtl"></textarea>
                                                            <div class="mt-2 flex items-center justify-between">
                                                                <div class="flex items-center gap-2">
                                                                    <small
                                                                        *ngIf="faqGroup.get('answer.ar')?.invalid && faqGroup.get('answer.ar')?.touched"
                                                                        class="text-red-500 flex items-center gap-1">
                                                                        <i
                                                                            class="pi pi-exclamation-triangle text-xs"></i>
                                                                          
                                                                    </small>
                                                                </div>
                                                                <small class="text-gray-500">
                                                                    {{ faqGroup.get('answer.ar')?.value?.length || 0 }}
                                                                    
                                                                </small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Empty State -->
                                        <div *ngIf="faqArray.length === 0" class="text-center py-16">
                                            <div
                                                class="w-24 h-24 bg-gradient-to-br from-orange-100 to-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
                                                <i class="pi pi-question-circle text-4xl text-orange-500"></i>
                                            </div>
                                            <h3 class="text-xl font-semibold text-gray-900 mb-3">No FAQ Items Yet</h3>
                                            <p class="text-gray-600 mb-6 max-w-md mx-auto">
                                                Start building your FAQ section by adding common questions and their
                                                answers.
                                                This will help your customers find information quickly.
                                            </p>
                                            <p-button label="Add Your First FAQ" icon="pi pi-plus" (onClick)="addFAQ()"
                                                styleClass="p-button-success"></p-button>
                                        </div>

                                        <!-- Add More Button -->
                                        <div *ngIf="faqArray.length > 0" class="text-center pt-4">
                                            <p-button label="Add Another FAQ" icon="pi pi-plus" (onClick)="addFAQ()"
                                                styleClass="p-button-outlined"></p-button>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-card>

                            <!-- Legal Documents -->
                            <div class="grid grid-cols-1 gap-8">
                                <!-- Privacy Policy -->
                                <p-card styleClass="shadow-lg border-0 mb-4">
                                    <ng-template pTemplate="header">
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-t-lg">
                                            <div class="flex items-center gap-3">
                                                <i class="pi pi-shield text-2xl"></i>
                                                <h2 class="text-xl font-semibold m-0">Privacy Policy</h2>
                                            </div>
                                            <p-button *ngIf="isEditMode()" label="Toggle Editor" icon="pi pi-edit"
                                                (onClick)="toggleEditor()"
                                                styleClass="p-button-outlined p-button-sm"></p-button>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="content">
                                        @if(!isEditMode()) {
                                        <!-- View Mode - Enhanced Legal Document Display -->
                                        <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
                                            <!-- English Version -->
                                            <div
                                                class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
                                                <div class="flex items-center gap-3 mb-4">
                                                    <div
                                                        class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-flag text-blue-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800">English Version</h3>
                                                </div>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div [innerHTML]="(businessProfile?.privacyPolicy?.en || '') | safe:'html'"
                                                        class="w-full ql-editor prose prose-sm max-w-none"></div>
                                                </div>
                                            </div>

                                            <!-- Arabic Version -->
                                            <div
                                                class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                                                <div class="flex items-center gap-3 mb-4">
                                                    <div
                                                        class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-flag text-green-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800"> </h3>
                                                </div>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div [innerHTML]="(businessProfile?.privacyPolicy?.ar || '') | safe:'html'"
                                                        class="w-full ql-editor prose prose-sm max-w-none" dir="rtl">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        } @else {
                                        <!-- Edit Mode -->
                                        <div *ngIf="!showEditor() || !isEditMode()">
                                            <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"
                                                formGroupName="privacyPolicy">
                                                <div>
                                                    <h4 class="font-semibold text-gray-900 mb-3">English</h4>
                                                    <div [innerHTML]="businessProfileForm.get('privacyPolicy.en')?.value | safe:'html'"
                                                        class="w-full ql-editor"></div>
                                                </div>
                                                <div>
                                                    <h4 class="font-semibold text-gray-900 mb-3"></h4>
                                                    <div [innerHTML]="businessProfileForm.get('privacyPolicy.ar')?.value | safe:'html'"
                                                        class="w-full ql-editor" dir="rtl"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngIf="showEditor() && isEditMode()">
                                            <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"
                                                formGroupName="privacyPolicy">
                                                <div>
                                                    <label
                                                        class="block text-sm font-medium text-gray-700 mb-2">English</label>
                                                    <p-editor formControlName="en" [style]="{'height':'320px'}"
                                                        placeholder="Enter your privacy policy content in English..."></p-editor>
                                                </div>
                                                <div>
                                                    <label
                                                        class="block text-sm font-medium text-gray-700 mb-2"></label>
                                                    <p-editor formControlName="ar" [style]="{'height':'320px'}"
                                                        placeholder="    ..."></p-editor>
                                                </div>
                                            </div>
                                        </div>
                                        }
                                    </ng-template>
                                </p-card>

                                <!-- Terms of Service -->
                                <p-card styleClass="shadow-lg border-0 mb-4">
                                    <ng-template pTemplate="header">
                                        <div
                                            class="flex items-center justify-between p-4 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-t-lg">
                                            <div class="flex items-center gap-3">
                                                <i class="pi pi-file text-2xl"></i>
                                                <h2 class="text-xl font-semibold m-0">Terms of Service</h2>
                                            </div>
                                            <p-button *ngIf="isEditMode()" label="Toggle Editor" icon="pi pi-edit"
                                                (onClick)="toggleEditor()"
                                                styleClass="p-button-outlined p-button-sm"></p-button>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="content">
                                        @if(!isEditMode()) {
                                        <!-- View Mode - Enhanced Legal Document Display -->
                                        <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
                                            <!-- English Version -->
                                            <div
                                                class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                                                <div class="flex items-center gap-3 mb-4">
                                                    <div
                                                        class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-flag text-green-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800">English Version</h3>
                                                </div>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div [innerHTML]="(businessProfile?.termsOfService?.en || '') | safe:'html'"
                                                        class="w-full ql-editor prose prose-sm max-w-none"></div>
                                                </div>
                                            </div>

                                            <!-- Arabic Version -->
                                            <div
                                                class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-6 border border-emerald-200">
                                                <div class="flex items-center gap-3 mb-4">
                                                    <div
                                                        class="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center">
                                                        <i class="pi pi-flag text-emerald-600"></i>
                                                    </div>
                                                    <h3 class="text-lg font-semibold text-gray-800"> </h3>
                                                </div>
                                                <div class="bg-white rounded-lg p-4 border border-gray-200">
                                                    <div [innerHTML]="(businessProfile?.termsOfService?.ar || '') | safe:'html'"
                                                        class="w-full ql-editor prose prose-sm max-w-none" dir="rtl">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        } @else {
                                        <!-- Edit Mode -->
                                        <div *ngIf="!showEditor() || !isEditMode()">
                                            <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"
                                                formGroupName="termsOfService">
                                                <div>
                                                    <h4 class="font-semibold text-gray-900 mb-3">English</h4>
                                                    <div [innerHTML]="businessProfileForm.get('termsOfService.en')?.value | safe:'html'"
                                                        class="w-full ql-editor"></div>
                                                </div>
                                                <div>
                                                    <h4 class="font-semibold text-gray-900 mb-3"></h4>
                                                    <div [innerHTML]="businessProfileForm.get('termsOfService.ar')?.value | safe:'html'"
                                                        class="w-full ql-editor" dir="rtl"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngIf="showEditor() && isEditMode()">
                                            <div class="space-y-6 grid grid-cols-1 lg:grid-cols-2 gap-8"
                                                formGroupName="termsOfService">
                                                <div>
                                                    <label
                                                        class="block text-sm font-medium text-gray-700 mb-2">English</label>
                                                    <p-editor formControlName="en" [style]="{'height':'320px'}"
                                                        placeholder="Enter your terms of service content in English..."></p-editor>
                                                </div>
                                                <div>
                                                    <label
                                                        class="block text-sm font-medium text-gray-700 mb-2"></label>
                                                    <p-editor formControlName="ar" [style]="{'height':'320px'}"
                                                        placeholder="    ..."></p-editor>
                                                </div>
                                            </div>
                                        </div>
                                        }
                                    </ng-template>
                                </p-card>
                            </div>
                        </div>
                    </p-tabPanel>

                    <!-- SEO & Meta Tags Tab -->
                    <p-tabPanel [header]="'businessProfile.tabs.seoMeta' | translate" leftIcon="pi pi-search">
                        <div class="p-6 space-y-6">
                            <!-- SEO Basic Fields -->
                            <p-card styleClass="shadow-lg border-0">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-teal-600 to-cyan-600 text-white rounded-t-lg">
                                        <i class="pi pi-search text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">SEO Settings</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <div class="space-y-6">
                                        <!-- Meta Title -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Meta
                                                Title</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4"
                                                formGroupName="metaTitle">
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1">English</label>
                                                    <input type="text" pInputText formControlName="en" class="w-full"
                                                        [readonly]="!isEditMode()"
                                                        placeholder="Enter SEO meta title in English (50-60 characters recommended)"
                                                        maxlength="70">
                                                    <small class="text-gray-500">
                                                        {{ businessProfileForm.get('metaTitle.en')?.value?.length || 0
                                                        }}/70 characters
                                                    </small>
                                                </div>
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1"></label>
                                                    <input type="text" pInputText formControlName="ar" class="w-full"
                                                        [readonly]="!isEditMode()"
                                                        placeholder="  SEO  (50-60   )"
                                                        dir="rtl" maxlength="70">
                                                    <small class="text-gray-500">
                                                        {{ businessProfileForm.get('metaTitle.ar')?.value?.length || 0
                                                        }}/70 
                                                    </small>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Meta Description -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Meta
                                                Description</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4"
                                                formGroupName="metaDescription">
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1">English</label>
                                                    <textarea pInputTextarea formControlName="en" rows="3"
                                                        class="w-full" [readonly]="!isEditMode()"
                                                        placeholder="Enter SEO meta description in English (150-160 characters recommended)"
                                                        maxlength="170"></textarea>
                                                    <small class="text-gray-500">
                                                        {{ businessProfileForm.get('metaDescription.en')?.value?.length
                                                        || 0 }}/170 characters
                                                    </small>
                                                </div>
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1"></label>
                                                    <textarea pInputTextarea formControlName="ar" rows="3"
                                                        class="w-full" [readonly]="!isEditMode()"
                                                        placeholder="  SEO  (150-160   )"
                                                        dir="rtl" maxlength="170"></textarea>
                                                    <small class="text-gray-500">
                                                        {{ businessProfileForm.get('metaDescription.ar')?.value?.length
                                                        || 0 }}/170 
                                                    </small>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Meta Keywords -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Meta
                                                Keywords</label>
                                            <textarea pInputTextarea formControlName="metaKeywords" rows="3"
                                                class="w-full" [readonly]="!isEditMode()"
                                                placeholder="Enter keywords separated by commas (e.g., business, company, services)"></textarea>
                                        </div>

                                        <!-- Site Name -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Site Name</label>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" formGroupName="siteName">
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1">English</label>
                                                    <input type="text" pInputText formControlName="en" class="w-full"
                                                        [readonly]="!isEditMode()"
                                                        placeholder="Enter site name in English">
                                                </div>
                                                <div>
                                                    <label class="block text-xs text-gray-600 mb-1"></label>
                                                    <input type="text" pInputText formControlName="ar" class="w-full"
                                                        [readonly]="!isEditMode()"
                                                        placeholder="   " dir="rtl">
                                                </div>
                                            </div>
                                            <small class="text-gray-500 mt-1 block">
                                                Used for Open Graph, Twitter Card, and other social media sharing
                                            </small>
                                        </div>

                                        <!-- Base URL -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Base URL</label>
                                            <input type="url" pInputText formControlName="baseUrl" class="w-full"
                                                [readonly]="!isEditMode()"
                                                placeholder="https://www.nasijstore.com">
                                            <small class="text-gray-500 mt-1 block">
                                                Base URL of your website (used for generating absolute URLs)
                                            </small>
                                        </div>

                                        <!-- Canonical URL -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Canonical URL</label>
                                            <input type="url" pInputText formControlName="canonicalUrl" class="w-full"
                                                [readonly]="!isEditMode()"
                                                placeholder="https://www.nasijstore.com">
                                            <small class="text-gray-500 mt-1 block">
                                                Canonical URL for SEO (defaults to base URL if not specified)
                                            </small>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-card>

                            <!-- Custom Meta Tags -->
                            <p-card styleClass="shadow-lg border-0">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center gap-3 p-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-t-lg">
                                        <i class="pi pi-tags text-2xl"></i>
                                        <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.seoMeta.customMetaTags' | translate }}</h2>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <div class="space-y-4">
                                        @if(!isEditMode()) {
                                        <!-- View Mode -->
                                        @if (businessProfile && businessProfile.metaTags && typeof businessProfile.metaTags === 'string' && businessProfile.metaTags.trim()) {
                                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                            <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.seoMeta.metaTagsHtml' | translate }}</label>
                                            <pre class="bg-white p-4 rounded border border-gray-300 text-sm overflow-x-auto font-mono whitespace-pre-wrap">{{ businessProfile.metaTags }}</pre>
                                        </div>
                                        } @else {
                                        <div class="text-center py-12 border-2 border-dashed border-gray-300 rounded-lg">
                                            <i class="pi pi-tags text-4xl text-gray-400 mb-4"></i>
                                            <p class="text-gray-600">{{ 'businessProfile.seoMeta.noCustomMetaTags' | translate }}</p>
                                        </div>
                                        }
                                        } @else {
                                        <!-- Edit Mode -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Meta Tags HTML</label>
                                            <textarea pInputTextarea formControlName="metaTags" rows="8"
                                                class="w-full font-mono text-sm" 
                                                placeholder='<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:site_name" content="Your Site Name">'></textarea>
                                            <small class="text-gray-500 mt-1 block">
                                                Enter one or more meta tags as HTML. Each tag on a new line. Examples:
                                                <br>
                                                 <code>&lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;</code>
                                                <br>
                                                 <code>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</code>
                                                <br>
                                                 <code>&lt;meta property="og:site_name" content="Your Site Name"&gt;</code>
                                            </small>
                                        </div>
                                        }
                                    </div>
                                </ng-template>
                            </p-card>

                            <!-- Custom Scripts -->
                            <p-card styleClass="shadow-lg border-0">
                                <ng-template pTemplate="header">
                                    <div
                                        class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-t-lg">
                                        <div class="flex items-center gap-3">
                                            <i class="pi pi-code text-2xl"></i>
                                            <h2 class="text-xl font-semibold m-0">{{ 'businessProfile.seoMeta.customScripts' | translate }}</h2>
                                        </div>
                                        @if (isEditMode()) {
                                        <p-button [label]="'businessProfile.seoMeta.addScript' | translate" icon="pi pi-plus" (onClick)="addScript()"
                                            styleClass="p-button-outlined p-button-sm"></p-button>
                                        }
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <div class="space-y-4">
                                        @for (scriptGroup of scriptsArray.controls; track $index) {
                                        <div class="border border-gray-200 rounded-lg p-4 bg-gray-50"
                                            [formGroup]="$any(scriptGroup)">
                                            <div class="space-y-4">
                                                <div class="flex items-center justify-between">
                                                    <label class="block text-sm font-medium text-gray-700">{{ 'businessProfile.seoMeta.scriptPosition' | translate }}</label>
                                                    @if (isEditMode()) {
                                                    <p-selectButton formControlName="position"
                                                        [options]="scriptPositionOptions" optionLabel="label"
                                                        optionValue="value"></p-selectButton>
                                                    } @else {
                                                    <p-chip [label]="scriptGroup.get('position')?.value || 'head'"
                                                        [styleClass]="scriptGroup.get('position')?.value === 'head' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'"></p-chip>
                                                    }
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">{{ 'businessProfile.seoMeta.scriptContent' | translate }}</label>
                                                    <textarea pInputTextarea formControlName="script" rows="6"
                                                        class="w-full font-mono text-sm" [readonly]="!isEditMode()"
                                                        [placeholder]="'businessProfile.seoMeta.scriptPlaceholder' | translate"></textarea>
                                                    @if (scriptGroup.get('script')?.invalid &&
                                                    scriptGroup.get('script')?.touched) {
                                                    <small class="text-red-500">{{ 'businessProfile.seoMeta.scriptContent' | translate }} {{ 'common.required' | translate }}</small>
                                                    }
                                                    <small class="text-gray-500 mt-1 block">
                                                        {{ 'businessProfile.seoMeta.scriptPlaceholder' | translate }}
                                                    </small>
                                                </div>
                                                @if (isEditMode()) {
                                                <div class="flex justify-end">
                                                    <p-button icon="pi pi-trash" (onClick)="removeScript($index)"
                                                        [label]="'businessProfile.seoMeta.removeScript' | translate"
                                                        styleClass="p-button-danger p-button-text"></p-button>
                                                </div>
                                                }
                                            </div>
                                        </div>
                                        }
                                        @if (scriptsArray.length === 0) {
                                        <div
                                            class="text-center py-12 border-2 border-dashed border-gray-300 rounded-lg">
                                            <i class="pi pi-code text-4xl text-gray-400 mb-4"></i>
                                            <p class="text-gray-600">{{ 'businessProfile.seoMeta.noScriptsAdded' | translate }}</p>
                                            @if (isEditMode()) {
                                            <p-button [label]="'businessProfile.seoMeta.addScript' | translate" icon="pi pi-plus" (onClick)="addScript()"
                                                styleClass="p-button-outlined mt-4"></p-button>
                                            }
                                        </div>
                                        }
                                    </div>
                                </ng-template>
                            </p-card>
                        </div>
                    </p-tabPanel>
                </p-tabView>
            </form>
        </div>

        <!-- No Profile Found -->
        <!-- <div *ngIf="!loading() && !businessProfile" class="text-center py-12">
            <div class="w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-6">
                <i class="pi pi-building text-3xl text-gray-400"></i>
            </div>
            <h2 class="text-2xl font-semibold text-gray-900 mb-4">No Business Profile Found</h2>
            <p class="text-gray-600 mb-6">Create your first business profile to get started.</p>
            <p-button label="Create Business Profile" icon="pi pi-plus" (onClick)="isEditMode.set(true)"
                styleClass="p-button-success"></p-button>
        </div> -->
    </div>
</div>